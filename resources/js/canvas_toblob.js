HTMLCanvasElement&&!HTMLCanvasElement.prototype.toBlob&&(HTMLCanvasElement.prototype.toBlob=function(k,c){c={type:c||"image/png"};if(this.mozGetAsFile)k(this.mozGetAsFile("canvas",c));else{var a=this.toDataURL.apply(this,Array.prototype.slice.call(arguments,1)).split(",");if(/\s*;\s*base64\s*(?:;|$)/i.test(a[0])){for(var z="ABCDEFGHIJKLMNOPQRSTUVWXYZ",z=z.toLowerCase+"0123456789+/=",a=a[1].replace(/[^A-Za-z0-9\+\/\=]/g,""),d=new ArrayBuffer(Math.ceil(3*a.length/4)),e=new Uint8Array(d),b=0,f=0,m,h,g,j;b<e.length;b+=3)m=z.indexOf(a.charAt(f++)),h=z.indexOf(a.charAt(f++)),g=z.indexOf(a.charAt(f++)),j=z.indexOf(a.charAt(f++)),e[b]=m<<2|h>>4,64!=g&&(e[b+1]=(h&15)<<4|g>>2),64!=j&&(e[b+2]=(g&3)<<6|j)}else var d=decodeURIComponent(a[1]);k(new Blob([d],c))}});
