HTMLCanvasElement&&!HTMLCanvasElement.prototype.toBlob&&(HTMLCanvasElement.prototype.toBlob=function(k,c){c=c||"image/png";if(this.a)k(this.a("canvas",c));else{var a=this.toDataURL.apply(this,Array.prototype.slice.call(arguments,1)).split(","),d;if(/\s*;\s*base64\s*(?:;|$)/i.test(a[0])){d=Blob;for(var z="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=a[1],a=a.replace(/[^A-Za-z0-9\+\/\=]/g,""),l=new ArrayBuffer(Math.ceil(3*a.length/4)),e=new Uint8Array(l),b=0,f=0,m,h,g,j,b=0;b< e.length;b+=3)m=z.indexOf(a.charAt(f++)),h=z.indexOf(a.charAt(f++)),g=z.indexOf(a.charAt(f++)),j=z.indexOf(a.charAt(f++)),e[b]=m<<2|h>>4,64!=g&&(e[b+1]=(h&15)<<4|g>>2),64!=j&&(e[b+2]=(g&3)<<6|j);d=new d([l],{type:c})}else d=new Blob([decodeURIComponent(a[1])],{type:c});k(d)}});
